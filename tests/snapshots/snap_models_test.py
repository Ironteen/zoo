# -*- coding: utf-8 -*-
# snapshottest: v1 - https://goo.gl/zC4yUc
from __future__ import unicode_literals

from snapshottest import Snapshot


snapshots = Snapshot()

snapshots['test_model_summary[BinaryAlexNet-256] 1'] = '''+binary_alexnet stats----------------------------------------------------------------------------------------------+
| Layer                  Input prec.                 Outputs   # 1-bit  # 32-bit   Memory  1-bit MACs  32-bit MACs |
|                              (bit)                               x 1       x 1     (kB)                          |
+------------------------------------------------------------------------------------------------------------------+
| input_1                          -  ((None, 224, 224, 3),)         0         0        0           ?            ? |
| quant_conv2d                     -        (-1, 56, 56, 64)     23232         0     2.84           0     72855552 |
| max_pooling2d                    -        (-1, 27, 27, 64)         0         0        0           0            0 |
| batch_normalization              -        (-1, 27, 27, 64)         0       192     0.75           0            0 |
| quant_conv2d_1                   1       (-1, 27, 27, 192)    307200         0    37.50   223948800            0 |
| max_pooling2d_1                  -       (-1, 13, 13, 192)         0         0        0           0            0 |
| batch_normalization_1            -       (-1, 13, 13, 192)         0       576     2.25           0            0 |
| quant_conv2d_2                   1       (-1, 13, 13, 384)    663552         0    81.00   112140288            0 |
| batch_normalization_2            -       (-1, 13, 13, 384)         0      1152     4.50           0            0 |
| quant_conv2d_3                   1       (-1, 13, 13, 384)   1327104         0   162.00   224280576            0 |
| batch_normalization_3            -       (-1, 13, 13, 384)         0      1152     4.50           0            0 |
| quant_conv2d_4                   1       (-1, 13, 13, 256)    884736         0   108.00   149520384            0 |
| max_pooling2d_2                  -         (-1, 6, 6, 256)         0         0        0           0            0 |
| batch_normalization_4            -         (-1, 6, 6, 256)         0       768     3.00           0            0 |
| flatten                          -              (-1, 9216)         0         0        0           0            0 |
| quant_dense                      1              (-1, 4096)  37748736         0  4608.00    37748736            0 |
| batch_normalization_5            -              (-1, 4096)         0     12288    48.00           0            0 |
| quant_dense_1                    1              (-1, 4096)  16777216         0  2048.00    16777216            0 |
| batch_normalization_6            -              (-1, 4096)         0     12288    48.00           0            0 |
| quant_dense_2                    1              (-1, 1000)   4096000         0   500.00     4096000            0 |
| batch_normalization_7            -              (-1, 1000)         0      3000    11.72           0            0 |
| activation                       -              (-1, 1000)         0         0        0           ?            ? |
+------------------------------------------------------------------------------------------------------------------+
| Total                                                       61827776     31416  7670.05   768512000     72855552 |
+------------------------------------------------------------------------------------------------------------------+
+binary_alexnet summary-----------------------+
| Total params                      61.9 M    |
| Trainable params                  61.8 M    |
| Non-trainable params              20.9 k    |
| Model size:                       7.49 MB   |
| Float-32 Equivalent               235.97 MB |
| Compression Ratio of Memory       0.03      |
| Number of MACs                    841 M     |
| Ratio of MACs that are binarized  0.9134    |
+---------------------------------------------+
'''

snapshots['test_model_summary[BiRealNet-512] 1'] = '''+birealnet18 stats----------------------------------------------------------------------------------------------------+
| Layer                     Input prec.                 Outputs   # 1-bit  # 32-bit   Memory  1-bit MACs  32-bit MACs |
|                                 (bit)                               x 1       x 1     (kB)                          |
+---------------------------------------------------------------------------------------------------------------------+
| input_1                             -  ((None, 224, 224, 3),)         0         0        0           ?            ? |
| conv2d                              -      (-1, 112, 112, 64)         0      9408    36.75           0    118013952 |
| batch_normalization                 -      (-1, 112, 112, 64)         0       256     1.00           0            0 |
| max_pooling2d                       -        (-1, 56, 56, 64)         0         0        0           0            0 |
| quant_conv2d                        1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_1               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add                                 -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| quant_conv2d_1                      1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_2               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add_1                               -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| quant_conv2d_2                      1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_3               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add_2                               -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| quant_conv2d_3                      1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_4               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add_3                               -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| average_pooling2d                   -        (-1, 28, 28, 64)         0         0        0           0            0 |
| quant_conv2d_4                      1       (-1, 28, 28, 128)     73728         0     9.00    57802752            0 |
| conv2d_1                            -       (-1, 28, 28, 128)         0      8192    32.00           0      6422528 |
| batch_normalization_6               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| batch_normalization_5               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_4                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| quant_conv2d_5                      1       (-1, 28, 28, 128)    147456         0    18.00   115605504            0 |
| batch_normalization_7               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_5                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| quant_conv2d_6                      1       (-1, 28, 28, 128)    147456         0    18.00   115605504            0 |
| batch_normalization_8               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_6                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| quant_conv2d_7                      1       (-1, 28, 28, 128)    147456         0    18.00   115605504            0 |
| batch_normalization_9               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_7                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| average_pooling2d_1                 -       (-1, 14, 14, 128)         0         0        0           0            0 |
| quant_conv2d_8                      1       (-1, 14, 14, 256)    294912         0    36.00    57802752            0 |
| conv2d_2                            -       (-1, 14, 14, 256)         0     32768   128.00           0      6422528 |
| batch_normalization_11              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| batch_normalization_10              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_8                               -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| quant_conv2d_9                      1       (-1, 14, 14, 256)    589824         0    72.00   115605504            0 |
| batch_normalization_12              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_9                               -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| quant_conv2d_10                     1       (-1, 14, 14, 256)    589824         0    72.00   115605504            0 |
| batch_normalization_13              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_10                              -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| quant_conv2d_11                     1       (-1, 14, 14, 256)    589824         0    72.00   115605504            0 |
| batch_normalization_14              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_11                              -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| average_pooling2d_2                 -         (-1, 7, 7, 256)         0         0        0           0            0 |
| quant_conv2d_12                     1         (-1, 7, 7, 512)   1179648         0   144.00    57802752            0 |
| conv2d_3                            -         (-1, 7, 7, 512)         0    131072   512.00           0      6422528 |
| batch_normalization_16              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| batch_normalization_15              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_12                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| quant_conv2d_13                     1         (-1, 7, 7, 512)   2359296         0   288.00   115605504            0 |
| batch_normalization_17              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_13                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| quant_conv2d_14                     1         (-1, 7, 7, 512)   2359296         0   288.00   115605504            0 |
| batch_normalization_18              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_14                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| quant_conv2d_15                     1         (-1, 7, 7, 512)   2359296         0   288.00   115605504            0 |
| batch_normalization_19              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_15                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| global_average_pooling2d            -               (-1, 512)         0         0        0           ?            ? |
| dense                               -              (-1, 1000)         0    513000  2003.91           0       512000 |
+---------------------------------------------------------------------------------------------------------------------+
| Total                                                          10985472    713640  4128.66  1676279808    137793536 |
+---------------------------------------------------------------------------------------------------------------------+
+birealnet18 summary-------------------------+
| Total params                      11.7 M   |
| Trainable params                  11.7 M   |
| Non-trainable params              9.60 k   |
| Model size:                       4.03 MB  |
| Float-32 Equivalent               44.63 MB |
| Compression Ratio of Memory       0.09     |
| Number of MACs                    1.81 B   |
| Ratio of MACs that are binarized  0.9240   |
+--------------------------------------------+
'''

snapshots['test_model_summary[BinaryResNetE18-512] 1'] = '''+binary_resnet_e_18 stats---------------------------------------------------------------------------------------------+
| Layer                     Input prec.                 Outputs   # 1-bit  # 32-bit   Memory  1-bit MACs  32-bit MACs |
|                                 (bit)                               x 1       x 1     (kB)                          |
+---------------------------------------------------------------------------------------------------------------------+
| input_1                             -  ((None, 224, 224, 3),)         0         0        0           ?            ? |
| conv2d                              -      (-1, 112, 112, 64)         0      9408    36.75           0    118013952 |
| batch_normalization                 -      (-1, 112, 112, 64)         0       256     1.00           0            0 |
| activation                          -      (-1, 112, 112, 64)         0         0        0           ?            ? |
| max_pooling2d                       -        (-1, 56, 56, 64)         0         0        0           0            0 |
| batch_normalization_1               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| quant_conv2d                        1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_2               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add                                 -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| quant_conv2d_1                      1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_3               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add_1                               -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| quant_conv2d_2                      1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_4               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add_2                               -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| quant_conv2d_3                      1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| batch_normalization_5               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| add_3                               -        (-1, 56, 56, 64)         0         0        0           ?            ? |
| average_pooling2d                   -        (-1, 28, 28, 64)         0         0        0           0            0 |
| quant_conv2d_4                      1       (-1, 28, 28, 128)     73728         0     9.00    57802752            0 |
| conv2d_1                            -       (-1, 28, 28, 128)         0      8192    32.00           0      6422528 |
| batch_normalization_7               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| batch_normalization_6               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_4                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| quant_conv2d_5                      1       (-1, 28, 28, 128)    147456         0    18.00   115605504            0 |
| batch_normalization_8               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_5                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| quant_conv2d_6                      1       (-1, 28, 28, 128)    147456         0    18.00   115605504            0 |
| batch_normalization_9               -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_6                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| quant_conv2d_7                      1       (-1, 28, 28, 128)    147456         0    18.00   115605504            0 |
| batch_normalization_10              -       (-1, 28, 28, 128)         0       512     2.00           0            0 |
| add_7                               -       (-1, 28, 28, 128)         0         0        0           ?            ? |
| average_pooling2d_1                 -       (-1, 14, 14, 128)         0         0        0           0            0 |
| quant_conv2d_8                      1       (-1, 14, 14, 256)    294912         0    36.00    57802752            0 |
| conv2d_2                            -       (-1, 14, 14, 256)         0     32768   128.00           0      6422528 |
| batch_normalization_12              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| batch_normalization_11              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_8                               -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| quant_conv2d_9                      1       (-1, 14, 14, 256)    589824         0    72.00   115605504            0 |
| batch_normalization_13              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_9                               -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| quant_conv2d_10                     1       (-1, 14, 14, 256)    589824         0    72.00   115605504            0 |
| batch_normalization_14              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_10                              -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| quant_conv2d_11                     1       (-1, 14, 14, 256)    589824         0    72.00   115605504            0 |
| batch_normalization_15              -       (-1, 14, 14, 256)         0      1024     4.00           0            0 |
| add_11                              -       (-1, 14, 14, 256)         0         0        0           ?            ? |
| average_pooling2d_2                 -         (-1, 7, 7, 256)         0         0        0           0            0 |
| quant_conv2d_12                     1         (-1, 7, 7, 512)   1179648         0   144.00    57802752            0 |
| conv2d_3                            -         (-1, 7, 7, 512)         0    131072   512.00           0      6422528 |
| batch_normalization_17              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| batch_normalization_16              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_12                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| quant_conv2d_13                     1         (-1, 7, 7, 512)   2359296         0   288.00   115605504            0 |
| batch_normalization_18              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_13                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| quant_conv2d_14                     1         (-1, 7, 7, 512)   2359296         0   288.00   115605504            0 |
| batch_normalization_19              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_14                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| quant_conv2d_15                     1         (-1, 7, 7, 512)   2359296         0   288.00   115605504            0 |
| batch_normalization_20              -         (-1, 7, 7, 512)         0      2048     8.00           0            0 |
| add_15                              -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| activation_1                        -         (-1, 7, 7, 512)         0         0        0           ?            ? |
| global_average_pooling2d            -               (-1, 512)         0         0        0           ?            ? |
| dense                               -              (-1, 1000)         0    513000  2003.91           0       512000 |
+---------------------------------------------------------------------------------------------------------------------+
| Total                                                          10985472    713896  4129.66  1676279808    137793536 |
+---------------------------------------------------------------------------------------------------------------------+
+binary_resnet_e_18 summary------------------+
| Total params                      11.7 M   |
| Trainable params                  11.7 M   |
| Non-trainable params              9.73 k   |
| Model size:                       4.03 MB  |
| Float-32 Equivalent               44.63 MB |
| Compression Ratio of Memory       0.09     |
| Number of MACs                    1.81 B   |
| Ratio of MACs that are binarized  0.9240   |
+--------------------------------------------+
'''

snapshots['test_model_summary[BinaryDenseNet28-576] 1'] = '''+binary_densenet28 stats---------------------------------------------------------------------------------------------+
| Layer                     Input prec.                 Outputs  # 1-bit  # 32-bit   Memory  1-bit MACs  32-bit MACs |
|                                 (bit)                              x 1       x 1     (kB)                          |
+--------------------------------------------------------------------------------------------------------------------+
| input_1                             -  ((None, 224, 224, 3),)        0         0        0           ?            ? |
| conv2d                              -      (-1, 112, 112, 64)        0      9408    36.75           0    118013952 |
| batch_normalization                 -      (-1, 112, 112, 64)        0       256     1.00           0            0 |
| activation                          -      (-1, 112, 112, 64)        0         0        0           ?            ? |
| max_pooling2d                       -        (-1, 56, 56, 64)        0         0        0           0            0 |
| batch_normalization_1               -        (-1, 56, 56, 64)        0       256     1.00           0            0 |
| quant_conv2d                        1        (-1, 56, 56, 64)    36864         0     4.50   115605504            0 |
| concatenate                         -       (-1, 56, 56, 128)        0         0        0           ?            ? |
| batch_normalization_2               -       (-1, 56, 56, 128)        0       512     2.00           0            0 |
| quant_conv2d_1                      1        (-1, 56, 56, 64)    73728         0     9.00   231211008            0 |
| concatenate_1                       -       (-1, 56, 56, 192)        0         0        0           ?            ? |
| batch_normalization_3               -       (-1, 56, 56, 192)        0       768     3.00           0            0 |
| quant_conv2d_2                      1        (-1, 56, 56, 64)   110592         0    13.50   346816512            0 |
| concatenate_2                       -       (-1, 56, 56, 256)        0         0        0           ?            ? |
| batch_normalization_4               -       (-1, 56, 56, 256)        0      1024     4.00           0            0 |
| quant_conv2d_3                      1        (-1, 56, 56, 64)   147456         0    18.00   462422016            0 |
| concatenate_3                       -       (-1, 56, 56, 320)        0         0        0           ?            ? |
| batch_normalization_5               -       (-1, 56, 56, 320)        0      1280     5.00           0            0 |
| quant_conv2d_4                      1        (-1, 56, 56, 64)   184320         0    22.50   578027520            0 |
| concatenate_4                       -       (-1, 56, 56, 384)        0         0        0           ?            ? |
| batch_normalization_6               -       (-1, 56, 56, 384)        0      1536     6.00           0            0 |
| quant_conv2d_5                      1        (-1, 56, 56, 64)   221184         0    27.00   693633024            0 |
| concatenate_5                       -       (-1, 56, 56, 448)        0         0        0           ?            ? |
| batch_normalization_7               -       (-1, 56, 56, 448)        0      1792     7.00           0            0 |
| max_pooling2d_1                     -       (-1, 28, 28, 448)        0         0        0           0            0 |
| activation_1                        -       (-1, 28, 28, 448)        0         0        0           ?            ? |
| conv2d_1                            -       (-1, 28, 28, 160)        0     71680   280.00           0     56197120 |
| batch_normalization_8               -       (-1, 28, 28, 160)        0       640     2.50           0            0 |
| quant_conv2d_6                      1        (-1, 28, 28, 64)    92160         0    11.25    72253440            0 |
| concatenate_6                       -       (-1, 28, 28, 224)        0         0        0           ?            ? |
| batch_normalization_9               -       (-1, 28, 28, 224)        0       896     3.50           0            0 |
| quant_conv2d_7                      1        (-1, 28, 28, 64)   129024         0    15.75   101154816            0 |
| concatenate_7                       -       (-1, 28, 28, 288)        0         0        0           ?            ? |
| batch_normalization_10              -       (-1, 28, 28, 288)        0      1152     4.50           0            0 |
| quant_conv2d_8                      1        (-1, 28, 28, 64)   165888         0    20.25   130056192            0 |
| concatenate_8                       -       (-1, 28, 28, 352)        0         0        0           ?            ? |
| batch_normalization_11              -       (-1, 28, 28, 352)        0      1408     5.50           0            0 |
| quant_conv2d_9                      1        (-1, 28, 28, 64)   202752         0    24.75   158957568            0 |
| concatenate_9                       -       (-1, 28, 28, 416)        0         0        0           ?            ? |
| batch_normalization_12              -       (-1, 28, 28, 416)        0      1664     6.50           0            0 |
| quant_conv2d_10                     1        (-1, 28, 28, 64)   239616         0    29.25   187858944            0 |
| concatenate_10                      -       (-1, 28, 28, 480)        0         0        0           ?            ? |
| batch_normalization_13              -       (-1, 28, 28, 480)        0      1920     7.50           0            0 |
| quant_conv2d_11                     1        (-1, 28, 28, 64)   276480         0    33.75   216760320            0 |
| concatenate_11                      -       (-1, 28, 28, 544)        0         0        0           ?            ? |
| batch_normalization_14              -       (-1, 28, 28, 544)        0      2176     8.50           0            0 |
| max_pooling2d_2                     -       (-1, 14, 14, 544)        0         0        0           0            0 |
| activation_2                        -       (-1, 14, 14, 544)        0         0        0           ?            ? |
| conv2d_2                            -       (-1, 14, 14, 192)        0    104448   408.00           0     20471808 |
| batch_normalization_15              -       (-1, 14, 14, 192)        0       768     3.00           0            0 |
| quant_conv2d_12                     1        (-1, 14, 14, 64)   110592         0    13.50    21676032            0 |
| concatenate_12                      -       (-1, 14, 14, 256)        0         0        0           ?            ? |
| batch_normalization_16              -       (-1, 14, 14, 256)        0      1024     4.00           0            0 |
| quant_conv2d_13                     1        (-1, 14, 14, 64)   147456         0    18.00    28901376            0 |
| concatenate_13                      -       (-1, 14, 14, 320)        0         0        0           ?            ? |
| batch_normalization_17              -       (-1, 14, 14, 320)        0      1280     5.00           0            0 |
| quant_conv2d_14                     1        (-1, 14, 14, 64)   184320         0    22.50    36126720            0 |
| concatenate_14                      -       (-1, 14, 14, 384)        0         0        0           ?            ? |
| batch_normalization_18              -       (-1, 14, 14, 384)        0      1536     6.00           0            0 |
| quant_conv2d_15                     1        (-1, 14, 14, 64)   221184         0    27.00    43352064            0 |
| concatenate_15                      -       (-1, 14, 14, 448)        0         0        0           ?            ? |
| batch_normalization_19              -       (-1, 14, 14, 448)        0      1792     7.00           0            0 |
| quant_conv2d_16                     1        (-1, 14, 14, 64)   258048         0    31.50    50577408            0 |
| concatenate_16                      -       (-1, 14, 14, 512)        0         0        0           ?            ? |
| batch_normalization_20              -       (-1, 14, 14, 512)        0      2048     8.00           0            0 |
| quant_conv2d_17                     1        (-1, 14, 14, 64)   294912         0    36.00    57802752            0 |
| concatenate_17                      -       (-1, 14, 14, 576)        0         0        0           ?            ? |
| batch_normalization_21              -       (-1, 14, 14, 576)        0      2304     9.00           0            0 |
| max_pooling2d_3                     -         (-1, 7, 7, 576)        0         0        0           0            0 |
| activation_3                        -         (-1, 7, 7, 576)        0         0        0           ?            ? |
| conv2d_3                            -         (-1, 7, 7, 256)        0    147456   576.00           0      7225344 |
| batch_normalization_22              -         (-1, 7, 7, 256)        0      1024     4.00           0            0 |
| quant_conv2d_18                     1          (-1, 7, 7, 64)   147456         0    18.00     7225344            0 |
| concatenate_18                      -         (-1, 7, 7, 320)        0         0        0           ?            ? |
| batch_normalization_23              -         (-1, 7, 7, 320)        0      1280     5.00           0            0 |
| quant_conv2d_19                     1          (-1, 7, 7, 64)   184320         0    22.50     9031680            0 |
| concatenate_19                      -         (-1, 7, 7, 384)        0         0        0           ?            ? |
| batch_normalization_24              -         (-1, 7, 7, 384)        0      1536     6.00           0            0 |
| quant_conv2d_20                     1          (-1, 7, 7, 64)   221184         0    27.00    10838016            0 |
| concatenate_20                      -         (-1, 7, 7, 448)        0         0        0           ?            ? |
| batch_normalization_25              -         (-1, 7, 7, 448)        0      1792     7.00           0            0 |
| quant_conv2d_21                     1          (-1, 7, 7, 64)   258048         0    31.50    12644352            0 |
| concatenate_21                      -         (-1, 7, 7, 512)        0         0        0           ?            ? |
| batch_normalization_26              -         (-1, 7, 7, 512)        0      2048     8.00           0            0 |
| quant_conv2d_22                     1          (-1, 7, 7, 64)   294912         0    36.00    14450688            0 |
| concatenate_22                      -         (-1, 7, 7, 576)        0         0        0           ?            ? |
| batch_normalization_27              -         (-1, 7, 7, 576)        0      2304     9.00           0            0 |
| activation_4                        -         (-1, 7, 7, 576)        0         0        0           ?            ? |
| global_average_pooling2d            -               (-1, 576)        0         0        0           ?            ? |
| dense                               -              (-1, 1000)        0    577000  2253.91           0       576000 |
+--------------------------------------------------------------------------------------------------------------------+
| Total                                                          4202496    948008  4216.16  3587383296    202484224 |
+--------------------------------------------------------------------------------------------------------------------+
+binary_densenet28 summary-------------------+
| Total params                      5.15 M   |
| Trainable params                  5.13 M   |
| Non-trainable params              19.0 k   |
| Model size:                       4.12 MB  |
| Float-32 Equivalent               19.65 MB |
| Compression Ratio of Memory       0.21     |
| Number of MACs                    3.79 B   |
| Ratio of MACs that are binarized  0.9466   |
+--------------------------------------------+
'''

snapshots['test_model_summary[BinaryDenseNet37-640] 1'] = '''+binary_densenet37 stats---------------------------------------------------------------------------------------------+
| Layer                     Input prec.                 Outputs  # 1-bit  # 32-bit   Memory  1-bit MACs  32-bit MACs |
|                                 (bit)                              x 1       x 1     (kB)                          |
+--------------------------------------------------------------------------------------------------------------------+
| input_1                             -  ((None, 224, 224, 3),)        0         0        0           ?            ? |
| conv2d                              -      (-1, 112, 112, 64)        0      9408    36.75           0    118013952 |
| batch_normalization                 -      (-1, 112, 112, 64)        0       256     1.00           0            0 |
| activation                          -      (-1, 112, 112, 64)        0         0        0           ?            ? |
| max_pooling2d                       -        (-1, 56, 56, 64)        0         0        0           0            0 |
| batch_normalization_1               -        (-1, 56, 56, 64)        0       256     1.00           0            0 |
| quant_conv2d                        1        (-1, 56, 56, 64)    36864         0     4.50   115605504            0 |
| concatenate                         -       (-1, 56, 56, 128)        0         0        0           ?            ? |
| batch_normalization_2               -       (-1, 56, 56, 128)        0       512     2.00           0            0 |
| quant_conv2d_1                      1        (-1, 56, 56, 64)    73728         0     9.00   231211008            0 |
| concatenate_1                       -       (-1, 56, 56, 192)        0         0        0           ?            ? |
| batch_normalization_3               -       (-1, 56, 56, 192)        0       768     3.00           0            0 |
| quant_conv2d_2                      1        (-1, 56, 56, 64)   110592         0    13.50   346816512            0 |
| concatenate_2                       -       (-1, 56, 56, 256)        0         0        0           ?            ? |
| batch_normalization_4               -       (-1, 56, 56, 256)        0      1024     4.00           0            0 |
| quant_conv2d_3                      1        (-1, 56, 56, 64)   147456         0    18.00   462422016            0 |
| concatenate_3                       -       (-1, 56, 56, 320)        0         0        0           ?            ? |
| batch_normalization_5               -       (-1, 56, 56, 320)        0      1280     5.00           0            0 |
| quant_conv2d_4                      1        (-1, 56, 56, 64)   184320         0    22.50   578027520            0 |
| concatenate_4                       -       (-1, 56, 56, 384)        0         0        0           ?            ? |
| batch_normalization_6               -       (-1, 56, 56, 384)        0      1536     6.00           0            0 |
| quant_conv2d_5                      1        (-1, 56, 56, 64)   221184         0    27.00   693633024            0 |
| concatenate_5                       -       (-1, 56, 56, 448)        0         0        0           ?            ? |
| batch_normalization_7               -       (-1, 56, 56, 448)        0      1792     7.00           0            0 |
| max_pooling2d_1                     -       (-1, 28, 28, 448)        0         0        0           0            0 |
| activation_1                        -       (-1, 28, 28, 448)        0         0        0           ?            ? |
| conv2d_1                            -       (-1, 28, 28, 128)        0     57344   224.00           0     44957696 |
| batch_normalization_8               -       (-1, 28, 28, 128)        0       512     2.00           0            0 |
| quant_conv2d_6                      1        (-1, 28, 28, 64)    73728         0     9.00    57802752            0 |
| concatenate_6                       -       (-1, 28, 28, 192)        0         0        0           ?            ? |
| batch_normalization_9               -       (-1, 28, 28, 192)        0       768     3.00           0            0 |
| quant_conv2d_7                      1        (-1, 28, 28, 64)   110592         0    13.50    86704128            0 |
| concatenate_7                       -       (-1, 28, 28, 256)        0         0        0           ?            ? |
| batch_normalization_10              -       (-1, 28, 28, 256)        0      1024     4.00           0            0 |
| quant_conv2d_8                      1        (-1, 28, 28, 64)   147456         0    18.00   115605504            0 |
| concatenate_8                       -       (-1, 28, 28, 320)        0         0        0           ?            ? |
| batch_normalization_11              -       (-1, 28, 28, 320)        0      1280     5.00           0            0 |
| quant_conv2d_9                      1        (-1, 28, 28, 64)   184320         0    22.50   144506880            0 |
| concatenate_9                       -       (-1, 28, 28, 384)        0         0        0           ?            ? |
| batch_normalization_12              -       (-1, 28, 28, 384)        0      1536     6.00           0            0 |
| quant_conv2d_10                     1        (-1, 28, 28, 64)   221184         0    27.00   173408256            0 |
| concatenate_10                      -       (-1, 28, 28, 448)        0         0        0           ?            ? |
| batch_normalization_13              -       (-1, 28, 28, 448)        0      1792     7.00           0            0 |
| quant_conv2d_11                     1        (-1, 28, 28, 64)   258048         0    31.50   202309632            0 |
| concatenate_11                      -       (-1, 28, 28, 512)        0         0        0           ?            ? |
| batch_normalization_14              -       (-1, 28, 28, 512)        0      2048     8.00           0            0 |
| quant_conv2d_12                     1        (-1, 28, 28, 64)   294912         0    36.00   231211008            0 |
| concatenate_12                      -       (-1, 28, 28, 576)        0         0        0           ?            ? |
| batch_normalization_15              -       (-1, 28, 28, 576)        0      2304     9.00           0            0 |
| quant_conv2d_13                     1        (-1, 28, 28, 64)   331776         0    40.50   260112384            0 |
| concatenate_13                      -       (-1, 28, 28, 640)        0         0        0           ?            ? |
| batch_normalization_16              -       (-1, 28, 28, 640)        0      2560    10.00           0            0 |
| max_pooling2d_2                     -       (-1, 14, 14, 640)        0         0        0           0            0 |
| activation_2                        -       (-1, 14, 14, 640)        0         0        0           ?            ? |
| conv2d_2                            -       (-1, 14, 14, 192)        0    122880   480.00           0     24084480 |
| batch_normalization_17              -       (-1, 14, 14, 192)        0       768     3.00           0            0 |
| quant_conv2d_14                     1        (-1, 14, 14, 64)   110592         0    13.50    21676032            0 |
| concatenate_14                      -       (-1, 14, 14, 256)        0         0        0           ?            ? |
| batch_normalization_18              -       (-1, 14, 14, 256)        0      1024     4.00           0            0 |
| quant_conv2d_15                     1        (-1, 14, 14, 64)   147456         0    18.00    28901376            0 |
| concatenate_15                      -       (-1, 14, 14, 320)        0         0        0           ?            ? |
| batch_normalization_19              -       (-1, 14, 14, 320)        0      1280     5.00           0            0 |
| quant_conv2d_16                     1        (-1, 14, 14, 64)   184320         0    22.50    36126720            0 |
| concatenate_16                      -       (-1, 14, 14, 384)        0         0        0           ?            ? |
| batch_normalization_20              -       (-1, 14, 14, 384)        0      1536     6.00           0            0 |
| quant_conv2d_17                     1        (-1, 14, 14, 64)   221184         0    27.00    43352064            0 |
| concatenate_17                      -       (-1, 14, 14, 448)        0         0        0           ?            ? |
| batch_normalization_21              -       (-1, 14, 14, 448)        0      1792     7.00           0            0 |
| quant_conv2d_18                     1        (-1, 14, 14, 64)   258048         0    31.50    50577408            0 |
| concatenate_18                      -       (-1, 14, 14, 512)        0         0        0           ?            ? |
| batch_normalization_22              -       (-1, 14, 14, 512)        0      2048     8.00           0            0 |
| quant_conv2d_19                     1        (-1, 14, 14, 64)   294912         0    36.00    57802752            0 |
| concatenate_19                      -       (-1, 14, 14, 576)        0         0        0           ?            ? |
| batch_normalization_23              -       (-1, 14, 14, 576)        0      2304     9.00           0            0 |
| quant_conv2d_20                     1        (-1, 14, 14, 64)   331776         0    40.50    65028096            0 |
| concatenate_20                      -       (-1, 14, 14, 640)        0         0        0           ?            ? |
| batch_normalization_24              -       (-1, 14, 14, 640)        0      2560    10.00           0            0 |
| quant_conv2d_21                     1        (-1, 14, 14, 64)   368640         0    45.00    72253440            0 |
| concatenate_21                      -       (-1, 14, 14, 704)        0         0        0           ?            ? |
| batch_normalization_25              -       (-1, 14, 14, 704)        0      2816    11.00           0            0 |
| quant_conv2d_22                     1        (-1, 14, 14, 64)   405504         0    49.50    79478784            0 |
| concatenate_22                      -       (-1, 14, 14, 768)        0         0        0           ?            ? |
| batch_normalization_26              -       (-1, 14, 14, 768)        0      3072    12.00           0            0 |
| quant_conv2d_23                     1        (-1, 14, 14, 64)   442368         0    54.00    86704128            0 |
| concatenate_23                      -       (-1, 14, 14, 832)        0         0        0           ?            ? |
| batch_normalization_27              -       (-1, 14, 14, 832)        0      3328    13.00           0            0 |
| quant_conv2d_24                     1        (-1, 14, 14, 64)   479232         0    58.50    93929472            0 |
| concatenate_24                      -       (-1, 14, 14, 896)        0         0        0           ?            ? |
| batch_normalization_28              -       (-1, 14, 14, 896)        0      3584    14.00           0            0 |
| quant_conv2d_25                     1        (-1, 14, 14, 64)   516096         0    63.00   101154816            0 |
| concatenate_25                      -       (-1, 14, 14, 960)        0         0        0           ?            ? |
| batch_normalization_29              -       (-1, 14, 14, 960)        0      3840    15.00           0            0 |
| max_pooling2d_3                     -         (-1, 7, 7, 960)        0         0        0           0            0 |
| activation_3                        -         (-1, 7, 7, 960)        0         0        0           ?            ? |
| conv2d_3                            -         (-1, 7, 7, 256)        0    245760   960.00           0     12042240 |
| batch_normalization_30              -         (-1, 7, 7, 256)        0      1024     4.00           0            0 |
| quant_conv2d_26                     1          (-1, 7, 7, 64)   147456         0    18.00     7225344            0 |
| concatenate_26                      -         (-1, 7, 7, 320)        0         0        0           ?            ? |
| batch_normalization_31              -         (-1, 7, 7, 320)        0      1280     5.00           0            0 |
| quant_conv2d_27                     1          (-1, 7, 7, 64)   184320         0    22.50     9031680            0 |
| concatenate_27                      -         (-1, 7, 7, 384)        0         0        0           ?            ? |
| batch_normalization_32              -         (-1, 7, 7, 384)        0      1536     6.00           0            0 |
| quant_conv2d_28                     1          (-1, 7, 7, 64)   221184         0    27.00    10838016            0 |
| concatenate_28                      -         (-1, 7, 7, 448)        0         0        0           ?            ? |
| batch_normalization_33              -         (-1, 7, 7, 448)        0      1792     7.00           0            0 |
| quant_conv2d_29                     1          (-1, 7, 7, 64)   258048         0    31.50    12644352            0 |
| concatenate_29                      -         (-1, 7, 7, 512)        0         0        0           ?            ? |
| batch_normalization_34              -         (-1, 7, 7, 512)        0      2048     8.00           0            0 |
| quant_conv2d_30                     1          (-1, 7, 7, 64)   294912         0    36.00    14450688            0 |
| concatenate_30                      -         (-1, 7, 7, 576)        0         0        0           ?            ? |
| batch_normalization_35              -         (-1, 7, 7, 576)        0      2304     9.00           0            0 |
| quant_conv2d_31                     1          (-1, 7, 7, 64)   331776         0    40.50    16257024            0 |
| concatenate_31                      -         (-1, 7, 7, 640)        0         0        0           ?            ? |
| batch_normalization_36              -         (-1, 7, 7, 640)        0      2560    10.00           0            0 |
| activation_4                        -         (-1, 7, 7, 640)        0         0        0           ?            ? |
| global_average_pooling2d            -               (-1, 640)        0         0        0           ?            ? |
| dense                               -              (-1, 1000)        0    641000  2503.91           0       640000 |
+--------------------------------------------------------------------------------------------------------------------+
| Total                                                          7593984   1140136  5380.66  4506808320    199738368 |
+--------------------------------------------------------------------------------------------------------------------+
+binary_densenet37 summary-------------------+
| Total params                      8.73 M   |
| Trainable params                  8.70 M   |
| Non-trainable params              31.9 k   |
| Model size:                       5.25 MB  |
| Float-32 Equivalent               33.32 MB |
| Compression Ratio of Memory       0.16     |
| Number of MACs                    4.71 B   |
| Ratio of MACs that are binarized  0.9576   |
+--------------------------------------------+
'''

snapshots['test_model_summary[BinaryDenseNet37Dilated-640] 1'] = '''+binary_densenet37_dilated stats-------------------------------------------------------------------------------------+
| Layer                     Input prec.                 Outputs  # 1-bit  # 32-bit   Memory  1-bit MACs  32-bit MACs |
|                                 (bit)                              x 1       x 1     (kB)                          |
+--------------------------------------------------------------------------------------------------------------------+
| input_1                             -  ((None, 224, 224, 3),)        0         0        0           ?            ? |
| conv2d                              -      (-1, 112, 112, 64)        0      9408    36.75           0    118013952 |
| batch_normalization                 -      (-1, 112, 112, 64)        0       256     1.00           0            0 |
| activation                          -      (-1, 112, 112, 64)        0         0        0           ?            ? |
| max_pooling2d                       -        (-1, 56, 56, 64)        0         0        0           0            0 |
| batch_normalization_1               -        (-1, 56, 56, 64)        0       256     1.00           0            0 |
| quant_conv2d                        1        (-1, 56, 56, 64)    36864         0     4.50   115605504            0 |
| concatenate                         -       (-1, 56, 56, 128)        0         0        0           ?            ? |
| batch_normalization_2               -       (-1, 56, 56, 128)        0       512     2.00           0            0 |
| quant_conv2d_1                      1        (-1, 56, 56, 64)    73728         0     9.00   231211008            0 |
| concatenate_1                       -       (-1, 56, 56, 192)        0         0        0           ?            ? |
| batch_normalization_3               -       (-1, 56, 56, 192)        0       768     3.00           0            0 |
| quant_conv2d_2                      1        (-1, 56, 56, 64)   110592         0    13.50   346816512            0 |
| concatenate_2                       -       (-1, 56, 56, 256)        0         0        0           ?            ? |
| batch_normalization_4               -       (-1, 56, 56, 256)        0      1024     4.00           0            0 |
| quant_conv2d_3                      1        (-1, 56, 56, 64)   147456         0    18.00   462422016            0 |
| concatenate_3                       -       (-1, 56, 56, 320)        0         0        0           ?            ? |
| batch_normalization_5               -       (-1, 56, 56, 320)        0      1280     5.00           0            0 |
| quant_conv2d_4                      1        (-1, 56, 56, 64)   184320         0    22.50   578027520            0 |
| concatenate_4                       -       (-1, 56, 56, 384)        0         0        0           ?            ? |
| batch_normalization_6               -       (-1, 56, 56, 384)        0      1536     6.00           0            0 |
| quant_conv2d_5                      1        (-1, 56, 56, 64)   221184         0    27.00   693633024            0 |
| concatenate_5                       -       (-1, 56, 56, 448)        0         0        0           ?            ? |
| batch_normalization_7               -       (-1, 56, 56, 448)        0      1792     7.00           0            0 |
| max_pooling2d_1                     -       (-1, 28, 28, 448)        0         0        0           0            0 |
| activation_1                        -       (-1, 28, 28, 448)        0         0        0           ?            ? |
| conv2d_1                            -       (-1, 28, 28, 128)        0     57344   224.00           0     44957696 |
| batch_normalization_8               -       (-1, 28, 28, 128)        0       512     2.00           0            0 |
| quant_conv2d_6                      1        (-1, 28, 28, 64)    73728         0     9.00    57802752            0 |
| concatenate_6                       -       (-1, 28, 28, 192)        0         0        0           ?            ? |
| batch_normalization_9               -       (-1, 28, 28, 192)        0       768     3.00           0            0 |
| quant_conv2d_7                      1        (-1, 28, 28, 64)   110592         0    13.50    86704128            0 |
| concatenate_7                       -       (-1, 28, 28, 256)        0         0        0           ?            ? |
| batch_normalization_10              -       (-1, 28, 28, 256)        0      1024     4.00           0            0 |
| quant_conv2d_8                      1        (-1, 28, 28, 64)   147456         0    18.00   115605504            0 |
| concatenate_8                       -       (-1, 28, 28, 320)        0         0        0           ?            ? |
| batch_normalization_11              -       (-1, 28, 28, 320)        0      1280     5.00           0            0 |
| quant_conv2d_9                      1        (-1, 28, 28, 64)   184320         0    22.50   144506880            0 |
| concatenate_9                       -       (-1, 28, 28, 384)        0         0        0           ?            ? |
| batch_normalization_12              -       (-1, 28, 28, 384)        0      1536     6.00           0            0 |
| quant_conv2d_10                     1        (-1, 28, 28, 64)   221184         0    27.00   173408256            0 |
| concatenate_10                      -       (-1, 28, 28, 448)        0         0        0           ?            ? |
| batch_normalization_13              -       (-1, 28, 28, 448)        0      1792     7.00           0            0 |
| quant_conv2d_11                     1        (-1, 28, 28, 64)   258048         0    31.50   202309632            0 |
| concatenate_11                      -       (-1, 28, 28, 512)        0         0        0           ?            ? |
| batch_normalization_14              -       (-1, 28, 28, 512)        0      2048     8.00           0            0 |
| quant_conv2d_12                     1        (-1, 28, 28, 64)   294912         0    36.00   231211008            0 |
| concatenate_12                      -       (-1, 28, 28, 576)        0         0        0           ?            ? |
| batch_normalization_15              -       (-1, 28, 28, 576)        0      2304     9.00           0            0 |
| quant_conv2d_13                     1        (-1, 28, 28, 64)   331776         0    40.50   260112384            0 |
| concatenate_13                      -       (-1, 28, 28, 640)        0         0        0           ?            ? |
| batch_normalization_16              -       (-1, 28, 28, 640)        0      2560    10.00           0            0 |
| activation_2                        -       (-1, 28, 28, 640)        0         0        0           ?            ? |
| conv2d_2                            -       (-1, 28, 28, 192)        0    122880   480.00           0     96337920 |
| batch_normalization_17              -       (-1, 28, 28, 192)        0       768     3.00           0            0 |
| quant_conv2d_14                     1        (-1, 28, 28, 64)   110592         0    13.50    86704128            0 |
| concatenate_14                      -       (-1, 28, 28, 256)        0         0        0           ?            ? |
| batch_normalization_18              -       (-1, 28, 28, 256)        0      1024     4.00           0            0 |
| quant_conv2d_15                     1        (-1, 28, 28, 64)   147456         0    18.00   115605504            0 |
| concatenate_15                      -       (-1, 28, 28, 320)        0         0        0           ?            ? |
| batch_normalization_19              -       (-1, 28, 28, 320)        0      1280     5.00           0            0 |
| quant_conv2d_16                     1        (-1, 28, 28, 64)   184320         0    22.50   144506880            0 |
| concatenate_16                      -       (-1, 28, 28, 384)        0         0        0           ?            ? |
| batch_normalization_20              -       (-1, 28, 28, 384)        0      1536     6.00           0            0 |
| quant_conv2d_17                     1        (-1, 28, 28, 64)   221184         0    27.00   173408256            0 |
| concatenate_17                      -       (-1, 28, 28, 448)        0         0        0           ?            ? |
| batch_normalization_21              -       (-1, 28, 28, 448)        0      1792     7.00           0            0 |
| quant_conv2d_18                     1        (-1, 28, 28, 64)   258048         0    31.50   202309632            0 |
| concatenate_18                      -       (-1, 28, 28, 512)        0         0        0           ?            ? |
| batch_normalization_22              -       (-1, 28, 28, 512)        0      2048     8.00           0            0 |
| quant_conv2d_19                     1        (-1, 28, 28, 64)   294912         0    36.00   231211008            0 |
| concatenate_19                      -       (-1, 28, 28, 576)        0         0        0           ?            ? |
| batch_normalization_23              -       (-1, 28, 28, 576)        0      2304     9.00           0            0 |
| quant_conv2d_20                     1        (-1, 28, 28, 64)   331776         0    40.50   260112384            0 |
| concatenate_20                      -       (-1, 28, 28, 640)        0         0        0           ?            ? |
| batch_normalization_24              -       (-1, 28, 28, 640)        0      2560    10.00           0            0 |
| quant_conv2d_21                     1        (-1, 28, 28, 64)   368640         0    45.00   289013760            0 |
| concatenate_21                      -       (-1, 28, 28, 704)        0         0        0           ?            ? |
| batch_normalization_25              -       (-1, 28, 28, 704)        0      2816    11.00           0            0 |
| quant_conv2d_22                     1        (-1, 28, 28, 64)   405504         0    49.50   317915136            0 |
| concatenate_22                      -       (-1, 28, 28, 768)        0         0        0           ?            ? |
| batch_normalization_26              -       (-1, 28, 28, 768)        0      3072    12.00           0            0 |
| quant_conv2d_23                     1        (-1, 28, 28, 64)   442368         0    54.00   346816512            0 |
| concatenate_23                      -       (-1, 28, 28, 832)        0         0        0           ?            ? |
| batch_normalization_27              -       (-1, 28, 28, 832)        0      3328    13.00           0            0 |
| quant_conv2d_24                     1        (-1, 28, 28, 64)   479232         0    58.50   375717888            0 |
| concatenate_24                      -       (-1, 28, 28, 896)        0         0        0           ?            ? |
| batch_normalization_28              -       (-1, 28, 28, 896)        0      3584    14.00           0            0 |
| quant_conv2d_25                     1        (-1, 28, 28, 64)   516096         0    63.00   404619264            0 |
| concatenate_25                      -       (-1, 28, 28, 960)        0         0        0           ?            ? |
| batch_normalization_29              -       (-1, 28, 28, 960)        0      3840    15.00           0            0 |
| activation_3                        -       (-1, 28, 28, 960)        0         0        0           ?            ? |
| conv2d_3                            -       (-1, 28, 28, 256)        0    245760   960.00           0    192675840 |
| batch_normalization_30              -       (-1, 28, 28, 256)        0      1024     4.00           0            0 |
| quant_conv2d_26                     1        (-1, 28, 28, 64)   147456         0    18.00   115605504            0 |
| concatenate_26                      -       (-1, 28, 28, 320)        0         0        0           ?            ? |
| batch_normalization_31              -       (-1, 28, 28, 320)        0      1280     5.00           0            0 |
| quant_conv2d_27                     1        (-1, 28, 28, 64)   184320         0    22.50   144506880            0 |
| concatenate_27                      -       (-1, 28, 28, 384)        0         0        0           ?            ? |
| batch_normalization_32              -       (-1, 28, 28, 384)        0      1536     6.00           0            0 |
| quant_conv2d_28                     1        (-1, 28, 28, 64)   221184         0    27.00   173408256            0 |
| concatenate_28                      -       (-1, 28, 28, 448)        0         0        0           ?            ? |
| batch_normalization_33              -       (-1, 28, 28, 448)        0      1792     7.00           0            0 |
| quant_conv2d_29                     1        (-1, 28, 28, 64)   258048         0    31.50   202309632            0 |
| concatenate_29                      -       (-1, 28, 28, 512)        0         0        0           ?            ? |
| batch_normalization_34              -       (-1, 28, 28, 512)        0      2048     8.00           0            0 |
| quant_conv2d_30                     1        (-1, 28, 28, 64)   294912         0    36.00   231211008            0 |
| concatenate_30                      -       (-1, 28, 28, 576)        0         0        0           ?            ? |
| batch_normalization_35              -       (-1, 28, 28, 576)        0      2304     9.00           0            0 |
| quant_conv2d_31                     1        (-1, 28, 28, 64)   331776         0    40.50   260112384            0 |
| concatenate_31                      -       (-1, 28, 28, 640)        0         0        0           ?            ? |
| batch_normalization_36              -       (-1, 28, 28, 640)        0      2560    10.00           0            0 |
| activation_4                        -       (-1, 28, 28, 640)        0         0        0           ?            ? |
| global_average_pooling2d            -               (-1, 640)        0         0        0           ?            ? |
| dense                               -              (-1, 1000)        0    641000  2503.91           0       640000 |
+--------------------------------------------------------------------------------------------------------------------+
| Total                                                          7593984   1140136  5380.66  7774470144    452625408 |
+--------------------------------------------------------------------------------------------------------------------+
+binary_densenet37_dilated summary-----------+
| Total params                      8.73 M   |
| Trainable params                  8.70 M   |
| Non-trainable params              31.9 k   |
| Model size:                       5.25 MB  |
| Float-32 Equivalent               33.32 MB |
| Compression Ratio of Memory       0.16     |
| Number of MACs                    8.23 B   |
| Ratio of MACs that are binarized  0.9450   |
+--------------------------------------------+
'''

snapshots['test_model_summary[BinaryDenseNet45-800] 1'] = '''+binary_densenet45 stats----------------------------------------------------------------------------------------------+
| Layer                     Input prec.                 Outputs   # 1-bit  # 32-bit   Memory  1-bit MACs  32-bit MACs |
|                                 (bit)                               x 1       x 1     (kB)                          |
+---------------------------------------------------------------------------------------------------------------------+
| input_1                             -  ((None, 224, 224, 3),)         0         0        0           ?            ? |
| conv2d                              -      (-1, 112, 112, 64)         0      9408    36.75           0    118013952 |
| batch_normalization                 -      (-1, 112, 112, 64)         0       256     1.00           0            0 |
| activation                          -      (-1, 112, 112, 64)         0         0        0           ?            ? |
| max_pooling2d                       -        (-1, 56, 56, 64)         0         0        0           0            0 |
| batch_normalization_1               -        (-1, 56, 56, 64)         0       256     1.00           0            0 |
| quant_conv2d                        1        (-1, 56, 56, 64)     36864         0     4.50   115605504            0 |
| concatenate                         -       (-1, 56, 56, 128)         0         0        0           ?            ? |
| batch_normalization_2               -       (-1, 56, 56, 128)         0       512     2.00           0            0 |
| quant_conv2d_1                      1        (-1, 56, 56, 64)     73728         0     9.00   231211008            0 |
| concatenate_1                       -       (-1, 56, 56, 192)         0         0        0           ?            ? |
| batch_normalization_3               -       (-1, 56, 56, 192)         0       768     3.00           0            0 |
| quant_conv2d_2                      1        (-1, 56, 56, 64)    110592         0    13.50   346816512            0 |
| concatenate_2                       -       (-1, 56, 56, 256)         0         0        0           ?            ? |
| batch_normalization_4               -       (-1, 56, 56, 256)         0      1024     4.00           0            0 |
| quant_conv2d_3                      1        (-1, 56, 56, 64)    147456         0    18.00   462422016            0 |
| concatenate_3                       -       (-1, 56, 56, 320)         0         0        0           ?            ? |
| batch_normalization_5               -       (-1, 56, 56, 320)         0      1280     5.00           0            0 |
| quant_conv2d_4                      1        (-1, 56, 56, 64)    184320         0    22.50   578027520            0 |
| concatenate_4                       -       (-1, 56, 56, 384)         0         0        0           ?            ? |
| batch_normalization_6               -       (-1, 56, 56, 384)         0      1536     6.00           0            0 |
| quant_conv2d_5                      1        (-1, 56, 56, 64)    221184         0    27.00   693633024            0 |
| concatenate_5                       -       (-1, 56, 56, 448)         0         0        0           ?            ? |
| batch_normalization_7               -       (-1, 56, 56, 448)         0      1792     7.00           0            0 |
| max_pooling2d_1                     -       (-1, 28, 28, 448)         0         0        0           0            0 |
| activation_1                        -       (-1, 28, 28, 448)         0         0        0           ?            ? |
| conv2d_1                            -       (-1, 28, 28, 160)         0     71680   280.00           0     56197120 |
| batch_normalization_8               -       (-1, 28, 28, 160)         0       640     2.50           0            0 |
| quant_conv2d_6                      1        (-1, 28, 28, 64)     92160         0    11.25    72253440            0 |
| concatenate_6                       -       (-1, 28, 28, 224)         0         0        0           ?            ? |
| batch_normalization_9               -       (-1, 28, 28, 224)         0       896     3.50           0            0 |
| quant_conv2d_7                      1        (-1, 28, 28, 64)    129024         0    15.75   101154816            0 |
| concatenate_7                       -       (-1, 28, 28, 288)         0         0        0           ?            ? |
| batch_normalization_10              -       (-1, 28, 28, 288)         0      1152     4.50           0            0 |
| quant_conv2d_8                      1        (-1, 28, 28, 64)    165888         0    20.25   130056192            0 |
| concatenate_8                       -       (-1, 28, 28, 352)         0         0        0           ?            ? |
| batch_normalization_11              -       (-1, 28, 28, 352)         0      1408     5.50           0            0 |
| quant_conv2d_9                      1        (-1, 28, 28, 64)    202752         0    24.75   158957568            0 |
| concatenate_9                       -       (-1, 28, 28, 416)         0         0        0           ?            ? |
| batch_normalization_12              -       (-1, 28, 28, 416)         0      1664     6.50           0            0 |
| quant_conv2d_10                     1        (-1, 28, 28, 64)    239616         0    29.25   187858944            0 |
| concatenate_10                      -       (-1, 28, 28, 480)         0         0        0           ?            ? |
| batch_normalization_13              -       (-1, 28, 28, 480)         0      1920     7.50           0            0 |
| quant_conv2d_11                     1        (-1, 28, 28, 64)    276480         0    33.75   216760320            0 |
| concatenate_11                      -       (-1, 28, 28, 544)         0         0        0           ?            ? |
| batch_normalization_14              -       (-1, 28, 28, 544)         0      2176     8.50           0            0 |
| quant_conv2d_12                     1        (-1, 28, 28, 64)    313344         0    38.25   245661696            0 |
| concatenate_12                      -       (-1, 28, 28, 608)         0         0        0           ?            ? |
| batch_normalization_15              -       (-1, 28, 28, 608)         0      2432     9.50           0            0 |
| quant_conv2d_13                     1        (-1, 28, 28, 64)    350208         0    42.75   274563072            0 |
| concatenate_13                      -       (-1, 28, 28, 672)         0         0        0           ?            ? |
| batch_normalization_16              -       (-1, 28, 28, 672)         0      2688    10.50           0            0 |
| quant_conv2d_14                     1        (-1, 28, 28, 64)    387072         0    47.25   303464448            0 |
| concatenate_14                      -       (-1, 28, 28, 736)         0         0        0           ?            ? |
| batch_normalization_17              -       (-1, 28, 28, 736)         0      2944    11.50           0            0 |
| quant_conv2d_15                     1        (-1, 28, 28, 64)    423936         0    51.75   332365824            0 |
| concatenate_15                      -       (-1, 28, 28, 800)         0         0        0           ?            ? |
| batch_normalization_18              -       (-1, 28, 28, 800)         0      3200    12.50           0            0 |
| quant_conv2d_16                     1        (-1, 28, 28, 64)    460800         0    56.25   361267200            0 |
| concatenate_16                      -       (-1, 28, 28, 864)         0         0        0           ?            ? |
| batch_normalization_19              -       (-1, 28, 28, 864)         0      3456    13.50           0            0 |
| quant_conv2d_17                     1        (-1, 28, 28, 64)    497664         0    60.75   390168576            0 |
| concatenate_17                      -       (-1, 28, 28, 928)         0         0        0           ?            ? |
| batch_normalization_20              -       (-1, 28, 28, 928)         0      3712    14.50           0            0 |
| max_pooling2d_2                     -       (-1, 14, 14, 928)         0         0        0           0            0 |
| activation_2                        -       (-1, 14, 14, 928)         0         0        0           ?            ? |
| conv2d_2                            -       (-1, 14, 14, 288)         0    267264  1044.00           0     52383744 |
| batch_normalization_21              -       (-1, 14, 14, 288)         0      1152     4.50           0            0 |
| quant_conv2d_18                     1        (-1, 14, 14, 64)    165888         0    20.25    32514048            0 |
| concatenate_18                      -       (-1, 14, 14, 352)         0         0        0           ?            ? |
| batch_normalization_22              -       (-1, 14, 14, 352)         0      1408     5.50           0            0 |
| quant_conv2d_19                     1        (-1, 14, 14, 64)    202752         0    24.75    39739392            0 |
| concatenate_19                      -       (-1, 14, 14, 416)         0         0        0           ?            ? |
| batch_normalization_23              -       (-1, 14, 14, 416)         0      1664     6.50           0            0 |
| quant_conv2d_20                     1        (-1, 14, 14, 64)    239616         0    29.25    46964736            0 |
| concatenate_20                      -       (-1, 14, 14, 480)         0         0        0           ?            ? |
| batch_normalization_24              -       (-1, 14, 14, 480)         0      1920     7.50           0            0 |
| quant_conv2d_21                     1        (-1, 14, 14, 64)    276480         0    33.75    54190080            0 |
| concatenate_21                      -       (-1, 14, 14, 544)         0         0        0           ?            ? |
| batch_normalization_25              -       (-1, 14, 14, 544)         0      2176     8.50           0            0 |
| quant_conv2d_22                     1        (-1, 14, 14, 64)    313344         0    38.25    61415424            0 |
| concatenate_22                      -       (-1, 14, 14, 608)         0         0        0           ?            ? |
| batch_normalization_26              -       (-1, 14, 14, 608)         0      2432     9.50           0            0 |
| quant_conv2d_23                     1        (-1, 14, 14, 64)    350208         0    42.75    68640768            0 |
| concatenate_23                      -       (-1, 14, 14, 672)         0         0        0           ?            ? |
| batch_normalization_27              -       (-1, 14, 14, 672)         0      2688    10.50           0            0 |
| quant_conv2d_24                     1        (-1, 14, 14, 64)    387072         0    47.25    75866112            0 |
| concatenate_24                      -       (-1, 14, 14, 736)         0         0        0           ?            ? |
| batch_normalization_28              -       (-1, 14, 14, 736)         0      2944    11.50           0            0 |
| quant_conv2d_25                     1        (-1, 14, 14, 64)    423936         0    51.75    83091456            0 |
| concatenate_25                      -       (-1, 14, 14, 800)         0         0        0           ?            ? |
| batch_normalization_29              -       (-1, 14, 14, 800)         0      3200    12.50           0            0 |
| quant_conv2d_26                     1        (-1, 14, 14, 64)    460800         0    56.25    90316800            0 |
| concatenate_26                      -       (-1, 14, 14, 864)         0         0        0           ?            ? |
| batch_normalization_30              -       (-1, 14, 14, 864)         0      3456    13.50           0            0 |
| quant_conv2d_27                     1        (-1, 14, 14, 64)    497664         0    60.75    97542144            0 |
| concatenate_27                      -       (-1, 14, 14, 928)         0         0        0           ?            ? |
| batch_normalization_31              -       (-1, 14, 14, 928)         0      3712    14.50           0            0 |
| quant_conv2d_28                     1        (-1, 14, 14, 64)    534528         0    65.25   104767488            0 |
| concatenate_28                      -       (-1, 14, 14, 992)         0         0        0           ?            ? |
| batch_normalization_32              -       (-1, 14, 14, 992)         0      3968    15.50           0            0 |
| quant_conv2d_29                     1        (-1, 14, 14, 64)    571392         0    69.75   111992832            0 |
| concatenate_29                      -      (-1, 14, 14, 1056)         0         0        0           ?            ? |
| batch_normalization_33              -      (-1, 14, 14, 1056)         0      4224    16.50           0            0 |
| quant_conv2d_30                     1        (-1, 14, 14, 64)    608256         0    74.25   119218176            0 |
| concatenate_30                      -      (-1, 14, 14, 1120)         0         0        0           ?            ? |
| batch_normalization_34              -      (-1, 14, 14, 1120)         0      4480    17.50           0            0 |
| quant_conv2d_31                     1        (-1, 14, 14, 64)    645120         0    78.75   126443520            0 |
| concatenate_31                      -      (-1, 14, 14, 1184)         0         0        0           ?            ? |
| batch_normalization_35              -      (-1, 14, 14, 1184)         0      4736    18.50           0            0 |
| max_pooling2d_3                     -        (-1, 7, 7, 1184)         0         0        0           0            0 |
| activation_3                        -        (-1, 7, 7, 1184)         0         0        0           ?            ? |
| conv2d_3                            -         (-1, 7, 7, 288)         0    340992  1332.00           0     16708608 |
| batch_normalization_36              -         (-1, 7, 7, 288)         0      1152     4.50           0            0 |
| quant_conv2d_32                     1          (-1, 7, 7, 64)    165888         0    20.25     8128512            0 |
| concatenate_32                      -         (-1, 7, 7, 352)         0         0        0           ?            ? |
| batch_normalization_37              -         (-1, 7, 7, 352)         0      1408     5.50           0            0 |
| quant_conv2d_33                     1          (-1, 7, 7, 64)    202752         0    24.75     9934848            0 |
| concatenate_33                      -         (-1, 7, 7, 416)         0         0        0           ?            ? |
| batch_normalization_38              -         (-1, 7, 7, 416)         0      1664     6.50           0            0 |
| quant_conv2d_34                     1          (-1, 7, 7, 64)    239616         0    29.25    11741184            0 |
| concatenate_34                      -         (-1, 7, 7, 480)         0         0        0           ?            ? |
| batch_normalization_39              -         (-1, 7, 7, 480)         0      1920     7.50           0            0 |
| quant_conv2d_35                     1          (-1, 7, 7, 64)    276480         0    33.75    13547520            0 |
| concatenate_35                      -         (-1, 7, 7, 544)         0         0        0           ?            ? |
| batch_normalization_40              -         (-1, 7, 7, 544)         0      2176     8.50           0            0 |
| quant_conv2d_36                     1          (-1, 7, 7, 64)    313344         0    38.25    15353856            0 |
| concatenate_36                      -         (-1, 7, 7, 608)         0         0        0           ?            ? |
| batch_normalization_41              -         (-1, 7, 7, 608)         0      2432     9.50           0            0 |
| quant_conv2d_37                     1          (-1, 7, 7, 64)    350208         0    42.75    17160192            0 |
| concatenate_37                      -         (-1, 7, 7, 672)         0         0        0           ?            ? |
| batch_normalization_42              -         (-1, 7, 7, 672)         0      2688    10.50           0            0 |
| quant_conv2d_38                     1          (-1, 7, 7, 64)    387072         0    47.25    18966528            0 |
| concatenate_38                      -         (-1, 7, 7, 736)         0         0        0           ?            ? |
| batch_normalization_43              -         (-1, 7, 7, 736)         0      2944    11.50           0            0 |
| quant_conv2d_39                     1          (-1, 7, 7, 64)    423936         0    51.75    20772864            0 |
| concatenate_39                      -         (-1, 7, 7, 800)         0         0        0           ?            ? |
| batch_normalization_44              -         (-1, 7, 7, 800)         0      3200    12.50           0            0 |
| activation_4                        -         (-1, 7, 7, 800)         0         0        0           ?            ? |
| global_average_pooling2d            -               (-1, 800)         0         0        0           ?            ? |
| dense                               -              (-1, 1000)         0    801000  3128.91           0       800000 |
+---------------------------------------------------------------------------------------------------------------------+
| Total                                                          12349440   1589800  7717.66  6430556160    244103424 |
+---------------------------------------------------------------------------------------------------------------------+
+binary_densenet45 summary-------------------+
| Total params                      13.9 M   |
| Trainable params                  13.9 M   |
| Non-trainable params              49.7 k   |
| Model size:                       7.54 MB  |
| Float-32 Equivalent               53.17 MB |
| Compression Ratio of Memory       0.14     |
| Number of MACs                    6.67 B   |
| Ratio of MACs that are binarized  0.9634   |
+--------------------------------------------+
'''

snapshots['test_model_summary[XNORNet-4096] 1'] = '''+xnornet stats------------------------------------------------------------------------------------------------------+
| Layer                  Input prec.                 Outputs   # 1-bit  # 32-bit    Memory  1-bit MACs  32-bit MACs |
|                              (bit)                               x 1       x 1      (kB)                          |
+-------------------------------------------------------------------------------------------------------------------+
| input_1                          -  ((None, 224, 224, 3),)         0         0         0           ?            ? |
| conv2d                           -        (-1, 56, 56, 96)         0     34848    136.12           0    109283328 |
| batch_normalization              -        (-1, 56, 56, 96)         0       288      1.12           0            0 |
| activation                       -        (-1, 56, 56, 96)         0         0         0           ?            ? |
| max_pooling2d                    -        (-1, 27, 27, 96)         0         0         0           0            0 |
| batch_normalization_1            -        (-1, 27, 27, 96)         0       288      1.12           0            0 |
| quant_conv2d                     1       (-1, 27, 27, 256)    614400         0     75.00   447897600            0 |
| max_pooling2d_1                  -       (-1, 13, 13, 256)         0         0         0           0            0 |
| batch_normalization_2            -       (-1, 13, 13, 256)         0       768      3.00           0            0 |
| quant_conv2d_1                   1       (-1, 13, 13, 384)    884736         0    108.00   149520384            0 |
| batch_normalization_3            -       (-1, 13, 13, 384)         0      1152      4.50           0            0 |
| quant_conv2d_2                   1       (-1, 13, 13, 384)   1327104         0    162.00   224280576            0 |
| batch_normalization_4            -       (-1, 13, 13, 384)         0      1152      4.50           0            0 |
| quant_conv2d_3                   1       (-1, 13, 13, 256)    884736         0    108.00   149520384            0 |
| max_pooling2d_2                  -         (-1, 6, 6, 256)         0         0         0           0            0 |
| batch_normalization_5            -         (-1, 6, 6, 256)         0       768      3.00           0            0 |
| quant_conv2d_4                   1        (-1, 1, 1, 4096)  37748736         0   4608.00    37748736            0 |
| batch_normalization_6            -        (-1, 1, 1, 4096)         0     12288     48.00           0            0 |
| quant_conv2d_5                   1        (-1, 1, 1, 4096)  16777216         0   2048.00    16777216            0 |
| batch_normalization_7            -        (-1, 1, 1, 4096)         0     12288     48.00           0            0 |
| activation_1                     -        (-1, 1, 1, 4096)         0         0         0           ?            ? |
| flatten                          -              (-1, 4096)         0         0         0           0            0 |
| dense                            -              (-1, 1000)         0   4096000  16000.00           0      4096000 |
| activation_2                     -              (-1, 1000)         0         0         0           ?            ? |
+-------------------------------------------------------------------------------------------------------------------+
| Total                                                       58236928   4159840  23358.38  1025744896    113379328 |
+-------------------------------------------------------------------------------------------------------------------+
+xnornet summary------------------------------+
| Total params                      62.4 M    |
| Trainable params                  62.4 M    |
| Non-trainable params              19.3 k    |
| Model size:                       22.81 MB  |
| Float-32 Equivalent               238.02 MB |
| Compression Ratio of Memory       0.10      |
| Number of MACs                    1.14 B    |
| Ratio of MACs that are binarized  0.9005    |
+---------------------------------------------+
'''

snapshots['test_model_summary[DoReFaNet-256] 1'] = '''+dorefanet stats----------------------------------------------------------------------------------------------------+
| Layer                  Input prec.                 Outputs   # 1-bit  # 32-bit    Memory  2-bit MACs  32-bit MACs |
|                              (bit)                               x 1       x 1      (kB)                          |
+-------------------------------------------------------------------------------------------------------------------+
| input_1                          -  ((None, 224, 224, 3),)         0         0         0           ?            ? |
| conv2d                           -        (-1, 54, 54, 96)         0     41568    162.38           0    120932352 |
| quant_conv2d                     2       (-1, 54, 54, 256)    614400         0     75.00  1791590400            0 |
| batch_normalization              -       (-1, 54, 54, 256)         0       768      3.00           0            0 |
| max_pooling2d                    -       (-1, 27, 27, 256)         0         0         0           0            0 |
| quant_conv2d_1                   2       (-1, 27, 27, 384)    884736         0    108.00   644972544            0 |
| batch_normalization_1            -       (-1, 27, 27, 384)         0      1152      4.50           0            0 |
| max_pooling2d_1                  -       (-1, 14, 14, 384)         0         0         0           0            0 |
| quant_conv2d_2                   2       (-1, 14, 14, 384)   1327104         0    162.00   260112384            0 |
| batch_normalization_2            -       (-1, 14, 14, 384)         0      1152      4.50           0            0 |
| quant_conv2d_3                   2       (-1, 14, 14, 256)    884736         0    108.00   173408256            0 |
| batch_normalization_3            -       (-1, 14, 14, 256)         0       768      3.00           0            0 |
| max_pooling2d_2                  -         (-1, 6, 6, 256)         0         0         0           0            0 |
| flatten                          -              (-1, 9216)         0         0         0           0            0 |
| quant_dense                      2              (-1, 4096)  37748736         0   4608.00    37748736            0 |
| batch_normalization_4            -              (-1, 4096)         0     12288     48.00           0            0 |
| quant_dense_1                    2              (-1, 4096)  16777216         0   2048.00    16777216            0 |
| batch_normalization_5            -              (-1, 4096)         0     12288     48.00           0            0 |
| activation                       -              (-1, 4096)         0         0         0           ?            ? |
| dense                            -              (-1, 1000)         0   4097000  16003.91           0      4096000 |
| activation_1                     -              (-1, 1000)         0         0         0           ?            ? |
+-------------------------------------------------------------------------------------------------------------------+
| Total                                                       58236928   4166984  23386.28  2924609536    125028352 |
+-------------------------------------------------------------------------------------------------------------------+
+dorefanet summary-----------------------------+
| Total params                       62.4 M    |
| Trainable params                   62.4 M    |
| Non-trainable params               18.9 k    |
| Model size:                        22.84 MB  |
| Float-32 Equivalent                238.05 MB |
| Compression Ratio of Memory        0.10      |
| Number of MACs                     3.05 B    |
| Ratio of MACs that are ternarized  0.9590    |
+----------------------------------------------+
'''
